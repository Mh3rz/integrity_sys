<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>All in One Dashboard</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="{{ url_for('static', filename='scripts/aliasLoader.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/storageManager.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/siteExtractor.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/iocAnalyzer.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/confluenceLoader.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/tabHandler.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/copyUtils.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/init.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/sidebarMenu.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/defaulTextModal.js') }}"></script>
    <style>
        html, body { height: 100%; }
    </style>
    </head>
    <body class="bg-gray-100 h-full">

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="hidden fixed inset-0 bg-black bg-opacity-30 z-40" onclick="toggleSidebar()"></div>

    <!-- Sidebar Panel (LEFT SIDE) -->
    <div id="settingsSidebar" class="hidden fixed top-0 left-0 w-64 h-full bg-white shadow-xl z-50 transition-transform transform -translate-x-full">
        <div class="flex justify-between items-center px-4 py-3 border-b">
            <h2 class="text-lg font-semibold">Settings</h2>
            <button onclick="toggleSidebar()" class="text-gray-600 hover:text-black text-xl">&times;</button>
        </div>
        <div class="p-4 space-y-4 text-sm">
            <!-- Open Settings Modal Button -->
            <button onclick="openTemplateEditor()" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100">
                üìù Set Default Input Template
            </button>
            <button onclick="alert('Option 2 clicked')" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100">üìÇ Option 2</button>
            <button onclick="alert('Option 3 clicked')" class="w-full text-left px-3 py-2 rounded hover:bg-gray-100">üíæ Option 3</button>
        </div>
    </div>
    <!-- Modal for editing default text -->
    <div id="templateModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white w-full max-w-2xl rounded-xl shadow-lg p-6">
            <h2 class="text-lg font-bold mb-2">Edit Default Input Template</h2>
            <textarea id="templateInput" class="w-full h-64 border rounded p-2 mb-4 resize-y" placeholder="Enter default text..."></textarea>
            <div class="flex justify-end space-x-2">
                <button onclick="closeTemplateEditor()" class="bg-gray-300 hover:bg-gray-400 text-sm px-3 py-1 rounded">Cancel</button>
                <button onclick="saveTemplate()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-1 rounded">Save</button>
            </div>
        </div>
    </div>
    <!-- ================================================================================================================= -->
    <!-- Header -->
    <div class="w-full bg-white shadow flex justify-between items-center p-4 font-semibold">
        <button onclick="toggleSidebar()" class="text-sm bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">‚öôÔ∏è Settings</button>
        <span class="text-blue-600">All in One - Dashboard</span>
        <a href="/alias-editor" class="text-sm bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">Manage Aliases</a>
    </div>

    <div class="flex h-[calc(100%-64px)]">
        <!-- Left Input -->
        <div class="w-[60%] h-full p-4">
            <div class="h-full bg-white p-6 rounded-xl shadow-lg flex flex-col">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold">Paste Your Input</h2>
                    <button onclick="extractAndCopyInput()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Process</button>
                </div>
                <textarea id="inputText" class="flex-1 border p-4 rounded resize-none" placeholder="Paste your alert text here..."></textarea>
                <button onclick="loadTemplate()" class="mt-3 bg-gray-200 text-sm px-4 py-2 rounded hover:bg-gray-300 self-start">
                    Reset to Default Template
                </button>

            </div>
        </div>

        <!-- Right Output -->
        <div class="w-[40%] h-full flex flex-col space-y-2 p-4">
            <!-- Tab Buttons -->
            <div class="flex border-b mb-2">
                <button onclick="showTab('iocAnalysisTab', this)" class="tab-button px-4 py-2 font-semibold text-blue-600 border-b-2 border-blue-600">IOC Analysis</button>
                <button onclick="showTab('summaryTab', this)" class="tab-button px-4 py-2 font-semibold text-gray-600 hover:text-blue-600">Processed Alerts</button>
                <button onclick="showTab('reportsTab', this)" class="tab-button px-4 py-2 font-semibold text-gray-600 hover:text-blue-600">Reports</button>
            </div>

        <!-- Summary Tab -->
        <div id="summaryTab" class="tab-content flex-1 flex flex-col space-y-2">
            <div class="flex justify-between items-center mb-2">
            <h2 class="text-xl font-bold">Processed Alerts</h2>
            <button onclick="copySummary()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Copy</button>
            </div>
            <textarea id="siteList" readonly class="w-full h-[90%] border p-4 rounded resize-none"></textarea>
        </div>

        <!-- Reports Tab -->
        <div id="reportsTab" class="tab-content hidden flex-1 flex flex-col space-y-4">

            <!-- Ticket Closed -->
            <div class="flex flex-col flex-grow">
                <label class="block font-semibold mb-1">Ticket Closed:</label>
                <textarea id="ticketClosedInput"
                    class="flex-grow min-h-[150px] border p-4 rounded resize-none"
                    placeholder="Enter ticket closure notes here..."></textarea>
            </div>

            <!-- Client Called -->
            <div class="flex flex-col flex-grow">
                <label class="block font-semibold mb-1">Client Called:</label>
                <textarea id="clientCalledInput"
                    class="flex-grow min-h-[150px] border p-4 rounded resize-none"
                    placeholder="Enter client call notes here..."></textarea>
            </div>

            <!-- Darknet Report -->
            <div class="flex flex-col flex-grow">
                <label class="block font-semibold mb-1">Darknet Report:</label>
                <textarea id="darknetInput"
                    class="flex-grow min-h-[150px] border p-4 rounded resize-none"
                    placeholder="Enter Darknet clients here..."></textarea>
            </div>

            <!-- Firewall Report -->
            <div class="flex flex-col flex-grow">
                <label class="block font-semibold mb-1">Firewall Report:</label>
                <textarea id="firewallInput"
                    class="flex-grow min-h-[150px] border p-4 rounded resize-none"
                    placeholder="Enter Firewall clients here..."></textarea>
            </div>

            <!-- Clear Button at Bottom -->
            <div class="flex justify-end mt-2">
                <button onclick="clearReports()" class="bg-red-500 hover:bg-red-600 text-white text-sm font-medium py-1 px-3 mb-3 rounded">
                    Clear All Summary/Reports
                </button>
            </div>
        </div>


        <!-- IOCs Tab -->
        <div id="iocAnalysisTab" class="tab-content hidden flex flex-col space-y-4 flex-1 overflow-hidden">
            <h3 class="text-xl font-bold">IOC Analysis</h3>

            <!-- VirusTotal Results -->
            <div class="flex flex-col flex-1 min-h-[200px]">
                <label class="block font-bold mb-1">VirusTotal Results</label>
                <div id="virustotalResults"
                    class="flex-1 border p-3 rounded overflow-auto bg-white whitespace-pre-wrap text-sm">
                </div>
            </div>

            <!-- AbuseIPDB Results -->
            <div class="flex flex-col flex-1 min-h-[200px]">
                <label class="block font-bold mb-1">AbuseIPDB Results</label>
                <div id="abuseipResults"
                    class="flex-1 border p-3 mb-3 rounded overflow-auto bg-white whitespace-pre-wrap text-sm">
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div id="clientInstructionsContainer" class="h-[40%] bg-white p-4 mt-6 rounded-xl shadow-lg overflow-auto">
            <h2 class="text-xl font-bold mb-2">Client Instructions</h2>
            <div id="siteInstructions" class="w-full h-[calc(100%-44px)] text-sm bg-gray-50 p-2 border rounded overflow-auto"></div>
        </div>


    </div>
</body>
</html>
